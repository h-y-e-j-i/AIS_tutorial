# 모델 커스텀 하기
## 모델 구조 확인하기
```python
result = trainer.train()    
model = trainer3.get_policy().model 
# policy id가 있다면
# model = trainer3.get_policy(policy id).model 
model.base_model.summary() # Access the base Keras models
model.state_value_head.summary() # Access the Q value model (specific to DQN)
model.q_value_head.summary() # Access the state value model (specific to DQN)
```
```
Model: "model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
observations (InputLayer)       [(None, 25)]         0                                            
__________________________________________________________________________________________________
fc_1 (Dense)                    (None, 256)          6656        observations[0][0]               
__________________________________________________________________________________________________
fc_out (Dense)                  (None, 256)          65792       fc_1[0][0]                       
__________________________________________________________________________________________________
value_out (Dense)               (None, 1)            257         fc_1[0][0]                       
==================================================================================================
Total params: 72,705
Trainable params: 72,705
Non-trainable params: 0
__________________________________________________________________________________________________
Model: "model_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
model_out (InputLayer)       [(None, 256)]             0         
_________________________________________________________________
dense_1 (Dense)              (None, 256)               65792     
_________________________________________________________________
dense_2 (Dense)              (None, 1)                 257       
=================================================================
Total params: 66,049
Trainable params: 66,049
Non-trainable params: 0
_________________________________________________________________
Model: "model_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
model_out (InputLayer)          [(None, 256)]        0                                            
__________________________________________________________________________________________________
hidden_0 (Dense)                (None, 256)          65792       model_out[0][0]                  
__________________________________________________________________________________________________
dense (Dense)                   (None, 4)            1028        hidden_0[0][0]                   
__________________________________________________________________________________________________
tf_op_layer_gneJ00/ones_like/Sh [(2,)]               0           dense[0][0]                      
__________________________________________________________________________________________________
tf_op_layer_gneJ00/ones_like_1/ [(2,)]               0           dense[0][0]                      
__________________________________________________________________________________________________
tf_op_layer_gneJ00/ones_like (T [(None, 4)]          0           tf_op_layer_gneJ00/ones_like/Shap
__________________________________________________________________________________________________
tf_op_layer_gneJ00/ones_like_1  [(None, 4)]          0           tf_op_layer_gneJ00/ones_like_1/Sh
__________________________________________________________________________________________________
tf_op_layer_gneJ00/ExpandDims ( [(None, 4, 1)]       0           tf_op_layer_gneJ00/ones_like[0][0
__________________________________________________________________________________________________
tf_op_layer_gneJ00/ExpandDims_1 [(None, 4, 1)]       0           tf_op_layer_gneJ00/ones_like_1[0]
==================================================================================================
Total params: 66,820
Trainable params: 66,820
Non-trainable params: 0
__________________________________________________________________________________________________
```
## 모델 그래프 저장하기
```python
result = trainer.train()    
policy_grpah = trainer.get_policy(policy_id).get_session().graph
with tensorflow.compat.v1.Graph().as_default():
writer = tensorflow.compat.v1.summary.FileWriter()
```
## 모델 그래프 확인하기
- 텐서보드에서 확인할 수 있다
- 그래프의 내용이 복잡한데, 아직 각각의 노드들의 의미와 연산을 이해하지 못했다.
```
tensorboard --logdir=path --host localhost
```
![image](https://user-images.githubusercontent.com/58590260/149295945-2ad2681f-9f66-434c-90df-9b296daed2fc.png)

